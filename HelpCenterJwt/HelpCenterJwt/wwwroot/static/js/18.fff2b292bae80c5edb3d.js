webpackJsonp([18],{Gl4p:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("lC5x"),a=o.n(r),i=o("J0Oq"),s=o.n(i),l=o("4YfN"),n=o.n(l),c=o("9rMa"),d=o("oweW"),m=o("Q+Tu"),u=o("8Fwj"),f=o("92M0"),p=(o("0ZYY"),o("npPj"),{name:"docListOperateAdd",data:function(){return{value:"",value1:"",form:{docNum:"",docTitle:"",isDefaultRole:!0,viewRoleList:[],editRoleList:[]},deptIdData:"",docTypeIdData:"",docUpLoad:"",rules:{docNum:[{required:!0,message:"请填写排序号",trigger:"blur"},{type:"number",message:"排序号必须为数字值",trigger:"blur"}],docTitle:[{required:!0,message:"请填写文章标题",trigger:"blur"}]}}},components:{xyDocEdit:f.a,xyDepartTreeSelect:d.a,xyCategoryTreeSelect:m.a,xyRoleSelect:u.a},mounted:function(){this.$refs.form.resetFields(),this.getTreeSelectData(),this.getCateTSData()},computed:n()({},Object(c.b)({tagIndex:"SET_MSGTAG"})),methods:{getViewRole:function(e){this.form.viewRoleList=e},getEditRole:function(e){this.form.editRoleList=e},getTreeSelectData:function(e){this.deptIdData=e,console.log(e)},getCateTSData:function(e){this.docTypeIdData=e},docEditor:function(e){this.form.docContent=e},docEditorText:function(e){this.form.docFullText=e},handleSuccess:function(e,t){this.docUpLoad=e.data,this.fileList=[]},handleChange:function(){var e=this;return s()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$refs.upload.submit();case 1:case"end":return t.stop()}},t,e)}))()},cancel:function(){this.$router.push("./docList"),this.$bus.$emit("closeTags",this.tagIndex)},onSubmit:function(){var e=this;this.form.docShareDeptList=[],this.form.docTypeId=this.docTypeIdData,this.form.docDeptId=this.deptIdData,this.form.docAttachment=this.docUpLoad,this.$refs.form.validate(function(t){if(!t)return void 0==e.form.docTypeId?(e.$message.error("文档分类未选择"),!1):void 0==e.form.docDeptId?(e.$message.error("部门分类未选择"),!1):(e.$message.error("添加失败"),!1);void 0!=e.form.docTypeId&&void 0!=e.form.docDeptId&&e.$axios.post("/api/HelpDoc",e.form).then(function(t){t.data.result?(e.$message({message:t.data.tips,type:"success"}),e.$bus.$emit("closeTags",e.tagIndex),e.$router.push("./docList"),e.$bus.$emit("DocListOperateAdd")):e.$message.error(t.data.tips)})})},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},handleExceed:function(e,t){this.$message.warning("当前限制选择 3 个文件，本次选择了 "+e.length+" 个文件，共选择了 "+(e.length+t.length)+" 个文件")},beforeRemove:function(e,t){return this.$confirm("确定移除 "+e.name+"？")}},deactivated:function(){this.$destroy()}}),v={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"doc-list-operate"},[o("div",{staticClass:"crumbs"},[o("el-breadcrumb",{attrs:{separator:"/"}},[o("el-breadcrumb-item",[o("i",{staticClass:"el-icon-setting"}),e._v("文档管理")]),e._v(" "),o("el-breadcrumb-item",[e._v("文档详情新增")])],1)],1),e._v(" "),o("div",{staticClass:"container"},[o("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[o("el-form-item",{attrs:{label:"排序号",prop:"docNum"}},[o("el-input",{attrs:{type:"number",onkeypress:"return( /[\\d]/.test(String.fromCharCode(event.keyCode) ) )"},model:{value:e.form.docNum,callback:function(t){e.$set(e.form,"docNum",e._n(t))},expression:"form.docNum"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"分类名称"}},[o("xy-category-tree-select",{on:{cateDTSelect:e.getCateTSData}})],1),e._v(" "),o("el-form-item",{attrs:{label:"文档名称",prop:"docTitle"}},[o("el-input",{attrs:{placeholder:""},model:{value:e.form.docTitle,callback:function(t){e.$set(e.form,"docTitle",t)},expression:"form.docTitle"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"归属部门"}},[o("xy-depart-tree-select",{on:{transferDTSelect:e.getTreeSelectData}})],1),e._v(" "),o("el-form-item",{attrs:{label:"查看权限",prop:"viewRoleList"}},[o("xy-role-select",{attrs:{value:e.form.viewRoleList},on:{input:e.getViewRole}})],1),e._v(" "),o("el-form-item",{attrs:{label:"编辑权限",prop:"viewRoleList"}},[o("xy-role-select",{attrs:{value:e.form.editRoleList},on:{input:e.getEditRole}})],1),e._v(" "),o("el-form-item",{attrs:{label:"游客查看"}},[o("el-switch",{model:{value:e.form.isDefaultRole,callback:function(t){e.$set(e.form,"isDefaultRole",t)},expression:"form.isDefaultRole"}})],1),e._v(" "),o("div",{staticClass:"doc-edit-box"},[o("label",[e._v("文档内容")]),e._v(" "),o("xy-doc-edit",{on:{docEditor:e.docEditor,docEditorText:e.docEditorText},model:{value:e.form.docContent,callback:function(t){e.$set(e.form,"docContent",t)},expression:"form.docContent"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"文档上传"}},[o("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"api/File","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"",limit:3,"auto-upload":!1,"on-change":e.handleChange,"on-exceed":e.handleExceed,"on-success":e.handleSuccess}},[o("el-button",{attrs:{type:"primary"}},[e._v("选择文件")])],1)],1),e._v(" "),o("el-form-item",[o("el-button",{on:{click:e.cancel}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")])],1)],1)],1)])},staticRenderFns:[]};var h=o("C7Lr")(p,v,!1,function(e){o("bakH")},null,null);t.default=h.exports},bakH:function(e,t){}});