webpackJsonp([6],{"04+N":function(e,t){},AloC:function(e,t){},Fdef:function(e,t){},X8uN:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={props:{value:{required:!0}},mounted:function(){this.loadSelectData()},components:{},data:function(){return{role:[],currentValue:this.value}},computed:{},methods:{onChange:function(e){this.$emit("input",e)},loadSelectData:function(){var e=this;this.$axios.get("api/Role/getAllList",{params:{isEnable:!0}}).then(function(t){t.data.result?(e.role=t.data.data,console.log(e.role)):e.$message.info(t.data.tips)}).catch(function(e){console.log("下拉框异常"),console.log(e)})}},watch:{value:function(e,t){this.currentValue=e}},filters:{},beforeDestroy:function(){}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{multiple:"",placeholder:"请选择角色"},on:{change:e.onChange},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}},e._l(e.role,function(e){return a("el-option",{key:e.roleId,attrs:{label:e.roleName,value:e.roleId}})}),1)},staticRenderFns:[]};var o=a("C7Lr")(s,r,!1,function(e){a("zWGa")},"data-v-4d16d440",null).exports,n={props:{userManageForm:{type:Object},formProps:{type:Object,default:function(){return{method:void 0}}}},mounted:function(){this.loadData()},components:{xyUserManageRoleSelect:o},data:function(){return{userManageForm2:{usrPhoneNum:"",usrAccount:"",usrPsw:"",usrName:"",roleIdList:[],usrType:2,usrDeptId:"",usrVerifyState:1,usrState:1},umfOptions:[],role:"",rules:{usrPhoneNum:[{required:!0,message:"请输入手机号",trigger:"blur"}],usrAccount:[{required:!0,message:"请输入账号",trigger:"blur"}],usrPsw:[{required:!0,message:"请输入密码",trigger:"blur"}],usrName:[{required:!0,message:"请输入昵称",trigger:"blur"}]}}},methods:{loadData:function(e){var t=this,a=e||t.formProps.usrId||1;this.$refs.userRole.loadSelectData(),t.$axios.get("/api/User",{params:{usrId:a}}).then(function(e){e.data.result&&(t.userManageForm2=e.data.data,t.userManageForm2.roleIdList=e.data.data.usrRoleIdLst)}).catch(function(e){console.log("DepartPeopleFrom的loadRowData方法catch到异常了"),console.log(e)})},getUserRole:function(e){this.userManageForm2.roleIdList=e},onSubmit:function(){if("post"===this.formProps.methods){var e=this,t=this.userManageForm2;this.$refs.form.validate(function(a){if(!a)return e.$message.error("添加失败"),!1;e.$axios.post("api/User",t).then(function(t){var a=t.data;0==a.result?e.$message.error(a.tips):e.$message(a.tips),e.$emit("modifyUmfSuccess")}).catch(function(e){console.log(e)})})}if("put"===this.formProps.methods){var a=this;console.log(this.userManageForm2),a.$axios.put("api/User?UsrId="+this.formProps.usrId,this.userManageForm2).then(function(e){var t=e.data;0==t.result?a.$message.error(t.tips):(a.$message({message:e.data.tips,type:"success"}),a.$emit("modifyUmfSuccess"))}).catch(function(e){console.log(e)})}},umClose:function(){this.$emit("umClose")},resetForm:function(){this.$refs.form.resetFields()}},watch:{}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"depart-form"},[a("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.userManageForm2,rules:e.rules}},[a("el-form-item",{attrs:{label:"手机号",prop:"usrPhoneNum"}},[a("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.userManageForm2.usrPhoneNum,callback:function(t){e.$set(e.userManageForm2,"usrPhoneNum",t)},expression:"userManageForm2.usrPhoneNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"账号",prop:"usrAccount"}},[a("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.userManageForm2.usrAccount,callback:function(t){e.$set(e.userManageForm2,"usrAccount",t)},expression:"userManageForm2.usrAccount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"usrPsw"}},[a("el-input",{attrs:{placeholder:"请输入登录密码"},model:{value:e.userManageForm2.usrPsw,callback:function(t){e.$set(e.userManageForm2,"usrPsw",t)},expression:"userManageForm2.usrPsw"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"昵称",prop:"usrName"}},[a("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.userManageForm2.usrName,callback:function(t){e.$set(e.userManageForm2,"usrName",t)},expression:"userManageForm2.usrName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"roleIdList"}},[a("xy-user-manage-role-select",{ref:"userRole",attrs:{value:e.userManageForm2.roleIdList},on:{input:e.getUserRole}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态",prop:"usrState"}},[a("el-radio-group",{model:{value:e.userManageForm2.usrState,callback:function(t){e.$set(e.userManageForm2,"usrState",t)},expression:"userManageForm2.usrState"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("禁用")])],1)],1),e._v(" "),a("el-form-item",{staticStyle:{display:"none"},attrs:{label:"用户类型",prop:"usrType"}},[a("el-input",{model:{value:e.userManageForm2.usrType,callback:function(t){e.$set(e.userManageForm2,"usrType",t)},expression:"userManageForm2.usrType"}})],1),e._v(" "),a("el-form-item",{staticStyle:{display:"none"},attrs:{label:"用户部门id",prop:"UsrDeptId"}},[a("el-input",{model:{value:e.userManageForm2.UsrDeptId,callback:function(t){e.$set(e.userManageForm2,"UsrDeptId",t)},expression:"userManageForm2.UsrDeptId"}})],1),e._v(" "),a("el-form-item",{staticStyle:{display:"none"},attrs:{label:"审核状态",prop:"usrVerifyState"}},[a("el-radio-group",{model:{value:e.userManageForm2.usrVerifyState,callback:function(t){e.$set(e.userManageForm2,"usrVerifyState",t)},expression:"userManageForm2.usrVerifyState"}},[a("el-radio",{attrs:{label:"1"}},[e._v("审核通过")]),e._v(" "),a("el-radio",{attrs:{label:"0"}},[e._v("审核不通过")])],1)],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:e.umClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var l=a("C7Lr")(n,i,!1,function(e){a("Fdef")},"data-v-b78caeb0",null).exports,u=a("aA9S"),c=a.n(u),m={mounted:function(){this.uMloadData()},props:{modifyVisible:"",resetVisible:"",dptinput:""},components:{},data:function(){return{selectionCol:!1,tableData:[],userManageForm:{usrName:"",usrAccount:"",usrPsw:"",usrType:0,usrVerifyState:0,usrPhoneNum:"",UsrDeptId:"a",roleIdList:[],usrState:0},idx:-1,judgePage:0,currentPage:1,pageTotal:0,pageSize:10}},computed:{},methods:{uMloadData:function(e,t){var a=this;void 0===e&&(e=a.currentPage);var s=c()({},{rowCount:a.pageSize,pageIndex:e,usrType:"1,2,3,4"},t);this.$axios.get("/api/User/pagelist",{params:s}).then(function(t){var s=t.data.data;s.info.forEach(function(e){1===e.usrState?e.usrState="启用":0===e.usrState&&(e.usrState="禁用")}),a.tableData=s.info,a.pageTotal=s.totalCount,a.currentPage=e,a.judgePage=0,console.log(a.currentPage)})},searchDptData:function(e,t){var a=this;a.judgePage=1,void 0!=e&&(a.dptinput=e);var s=c()({},{rowCount:a.pageSize,pageIndex:a.currentPage,userName:a.dptinput,usrType:"1,2,3,4"},t);this.$axios.get("api/User/keyword/username",{params:s}).then(function(e){var t=e.data.data;t.info.forEach(function(e){1===e.usrVerifystate?e.usrVerifystate="审核通过":0===e.usrVerifystate&&(e.usrVerifystate="审核不通过")}),a.tableData=t.info,a.pageTotal=t.totalCount,a.judgePage=1}).catch(function(e){console.log(e)})},handleCurrentChange:function(e){this.currentPage=e,0==this.judgePage?this.uMloadData():1==this.judgePage&&this.searchDptData()},handleModify:function(e,t){this.$emit("modifyVisibleChange",t)},handleModifyPass:function(e,t){this.$emit("resetVisibleChange",!0),this.idx=e;var a=this.tableData[e];this.userManageForm=a,this.$emit("umtEvent",this.userManageForm)},handleDelete:function(e){var t=this,a=this,s={usrId:e.usrId};console.log(s),this.$confirm("你真的删除这个用户吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$axios.delete("api/User",{params:s}).then(function(e){var s=e.data;console.log(e),!1===e.result?a.$message.error(s.tips):(a.$message(s.tips),t.uMloadData())})})},handleDisable:function(e){var t=this,a=this;"禁用"==e.usrState?e.usrState=1:e.usrState=0,a.$axios.put("api/User/enable/userid?UsrId="+e.usrId+"&usrState="+e.usrState).then(function(e){a.$message({message:e.data.tips,type:"success"}),t.uMloadData()}).catch(function(e){console.log(e)})}},watch:{},beforeDestroy:function(){}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"crdt",label:"创建时间",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"usrPhoneNum",label:"手机号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"usrAccount",label:"账号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"usrState",label:"状态",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"usrName",label:"昵称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleName",label:"角色",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"280",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handleModify(t.$index,t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handleModifyPass(t.$index,t.row)}}},[e._v("密码重置")]),e._v(" "),a("el-button",{staticClass:"red",attrs:{type:"text"},on:{click:function(a){e.handleDelete(t.row)}}},[e._v("删除")]),e._v(" "),a("el-button",{staticClass:"red",attrs:{type:"text"},on:{click:function(a){e.handleDisable(t.row)}}},[e._v("禁用")])]}}])})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.pageTotal},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1)],1)},staticRenderFns:[]};var p={props:{userManageForm:{}},data:function(){var e=this;return{umPassForm:{pass:"",checkPass:""},rules2:{pass:[{validator:function(t,a,s){""===a?s(new Error("请输入密码")):(""!==e.umPassForm.checkPass&&e.$refs.umPassForm.validateField("checkPass"),s())},trigger:"blur"}],checkPass:[{validator:function(t,a,s){""===a?s(new Error("请再次输入密码")):a!==e.umPassForm.pass?s(new Error("两次输入密码不一致!")):s()},trigger:"blur"}]}}},methods:{umPassSubmit:function(){var e=this,t=this;console.log(this.userManageForm),t.$axios.put("api/User/resetpsw/account?usrAccount="+this.userManageForm.usrAccount+"&Password="+this.umPassForm.pass).then(function(a){var s=a.data;0==s.result?t.$message.error(s.tips):e.$message({showClose:!0,message:s.tips,type:"success"})}).catch(function(e){console.log(e)})}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"umPassForm",staticClass:"demo-ruleForm",attrs:{model:e.umPassForm,"status-icon":"",rules:e.rules2,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"密码",prop:"pass"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.umPassForm.pass,callback:function(t){e.$set(e.umPassForm,"pass",t)},expression:"umPassForm.pass"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.umPassForm.checkPass,callback:function(t){e.$set(e.umPassForm,"checkPass",t)},expression:"umPassForm.checkPass"}})],1)],1)},staticRenderFns:[]},h={name:"userMange",data:function(){var e=this;return{formProps:{method:"put"},tip:"",dptinput:"",tableData:[],cur_page:1,multipleSelection:[],select_cate:"",select_word:"",del_list:[],is_search:!1,addVisible:!1,modifyVisible:!1,resetVisible:!1,delVisible:!1,userManageForm:{usrName:"",usrAccount:"",usrPsw:"",usrType:0,usrVerifyState:0,usrPhoneNum:"",UsrDeptId:"a",roleIdList:"",usrState:0,usrId:""},idx:-1,ruleForm2:{pass:"",checkPass:"",age:""},rules2:{pass:[{validator:function(t,a,s){""===a?s(new Error("请输入密码")):(""!==e.ruleForm2.checkPass&&e.$refs.ruleForm2.validateField("checkPass"),s())},trigger:"blur"}],checkPass:[{validator:function(t,a,s){""===a?s(new Error("请再次输入密码")):a!==e.ruleForm2.pass?s(new Error("两次输入密码不一致!")):s()},trigger:"blur"}]}}},created:function(){},components:{xyUserManageForm:l,xyUserManageTable:a("C7Lr")(m,d,!1,function(e){a("04+N")},"data-v-1d825a4c",null).exports,xyUserManagePass:a("C7Lr")(p,f,!1,null,null,null).exports},computed:{data:function(){}},methods:{getUmData:function(e){this.userManageForm=e,this.$refs.umModify&&this.$refs.umModify.loadData(e.usrId)},uMloadData:function(){this.$refs.umTable.uMloadData(1)},modifyUmfSuccess:function(){this.$refs.umTable.uMloadData(),this.addVisible=!1},dsmSearch:function(){this.$refs.umTable.searchDptData()},addUM:function(){this.tip="用户新增",this.formProps.methods="post",this.addVisible=!0,this.$refs.umFrom&&this.$refs.umFrom.resetForm()},modifyVisibleFun:function(e){this.tip="用户修改",this.formProps=e,this.formProps.methods="put",this.$refs.umFrom&&this.$refs.umFrom.loadData(e.usrId),this.addVisible=!0},umClose:function(){this.addVisible=!1},resetVisibleFun:function(e){this.resetVisible=e},onUmfSubmit:function(){this.$refs.umAdd.onUmfSubmit(),this.$refs.umTable.uMloadData(),this.addVisible=!1},modifyUmfSubmit:function(){this.$refs.umModify.modifyUmfSubmit(this.userManageForm)},umPassSubmit:function(){this.$refs.umPass.umPassSubmit(),this.resetVisible=!1},deleteRow:function(){this.tableData.splice(this.idx,1),this.$message.success("删除成功"),this.delVisible=!1}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 账户管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("用户管理")])],1)],1),e._v(" "),a("div",{staticClass:"container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-add",attrs:{type:"primary",icon:"add"},on:{click:function(t){e.addUM()}}},[e._v("新增")])],1)]),e._v(" "),a("el-col",{attrs:{span:16}},[a("div",{staticClass:"handle-search-box"},[a("span",[e._v("昵称:")]),e._v(" "),a("el-input",{staticClass:"search-w search",attrs:{size:"small",clearable:"",placeholder:"请输入关键字进行搜索"},on:{clear:e.uMloadData},model:{value:e.dptinput,callback:function(t){e.dptinput=t},expression:"dptinput"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.dsmSearch}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.uMloadData}},[e._v("重置")])],1)])],1),e._v(" "),a("xy-user-manage-table",{ref:"umTable",attrs:{dptinput:e.dptinput},on:{modifyVisibleChange:function(t){e.modifyVisibleFun(t)},resetVisibleChange:function(t){e.resetVisibleFun(t)},umtEvent:e.getUmData}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.tip,visible:e.addVisible,width:"30%"},on:{"update:visible":function(t){e.addVisible=t}}},[a("xy-user-manage-form",{ref:"umFrom",attrs:{formProps:e.formProps,userManageForm:e.userManageForm},on:{modifyUmfSuccess:e.modifyUmfSuccess,umClose:e.umClose}})],1),e._v(" "),a("el-dialog",{attrs:{title:"修改密码",visible:e.resetVisible,width:"30%"},on:{"update:visible":function(t){e.resetVisible=t}}},[a("xy-user-manage-pass",{ref:"umPass",attrs:{userManageForm:e.userManageForm}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.resetVisible=!1}}},[e._v("返回")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.umPassSubmit()}}},[e._v("提交")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.delVisible,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteRow}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var b=a("C7Lr")(h,g,!1,function(e){a("AloC")},"data-v-7cb17498",null);t.default=b.exports},zWGa:function(e,t){}});